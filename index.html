<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="style.css" />
        <title>Librairie Cookie Consent</title>
        <meta charset="utf-8" />
    </head>
    <body>
        <header>
            <h1>Mon site</h1>
            <p>Le site web créé par moi</p>
        </header>
        <nav>
            <ul>
                <li><a href="http://webtuto.weebly.com">Web Tuto</a></li>
                <li><a href="#">Accueil</a></li>
                <li><a href="#">Me contacter</a></li>
            </ul>
        </nav>
        <section>
            <aside>
                <h1>À propos de ce site</h1>
                <p>C'est mon site web et il est trop bien.</p>
            </aside>
            <article>               
                <h1>Tralalalère</h1>
                <p>je lange du poisson au petit déjeuner</p>
            </article>
        </section>

        <footer>
            <p>Copyright MonSite - Tous droits réservés</p>
        </footer>
        <div class="popup" id="popupConsent">
    <section id="contentPopupConsent">
      <p>Nous utilisons des cookies / publicités ciblés pour vous garantir la meilleure expérience sur notre site. Si vous continuez à utiliser ce dernier, nous considérerons que vous acceptez leurs utilisation. Pour en savoir plus, consultez notre <a href="https://www.dronement-drone.fr/politique-de-confidentialite">politique de confidentialité</a>.</p>
    </section>
    <section id="configureSection">
      <table>
        <tr>
          <th>
            <div class="switch checked" id="autoriseGeolocation">
              <div class="circle" id="autoriseGeolocationCircle"></div>
            </div>
          </th>
          <th class="text-switch">Autoriser l'accès aux données de géolocalisation</th>
        </tr>
        <tr>
          <th>
            <div class="switch checked" id="targetedAdvertising">
              <div class="circle" id="targetedAdvertisingCircle"></div>
            </div>
          </th>
          <th class="text-switch">Autoriser les annonces et contenus personnalisés, la mesure des annonces et l'analyse de l'audience.</th>
        </tr>
        <tr>
          <th>
            <div class="switch checked" id="cookieConsent">
              <div class="circle" id="cookieConsentCircle"></div>
            </div>
          </th>
          <th class="text-switch">Stocker et/ou accéder à des informations sur un appareil</th>
        </tr>
      </table>
    </section>
    <div class="choice-container-buttons">
      <button class="c-button" id="accept">
        <div class="c-ripple js-ripple">
          <span class="c-ripple-circle-accept"></span>
        </div>
        J'accepte tout
      </button>
      <button class="c-button" id="configure">
        <div class="c-ripple js-ripple">
          <span class="c-ripple-circle-configure"></span>
        </div>
        Configurer mes choix
      </button>
      <button class="c-button" id="enregistre">
        <div class="c-ripple js-ripple">
          <span class="c-ripple-circle-enregistre"></span>
        </div>
        Enregistrer mes choix
      </button>
    </div>
  </div>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script>
    //--------------Switch button-----------------
    $(".switch").click(function(){
      let idSwitch = "#" + $(this).attr('id');
      let idCircleSwitch = idSwitch + "Circle";

      if($(idSwitch).hasClass('checked')){
        $(idCircleSwitch).removeClass("move-circle-right").addClass("move-circle-left");
        $(idSwitch).removeClass("checked");
      }
      else{
        $(idCircleSwitch).removeClass("move-circle-left").addClass("move-circle-right");
        $(idSwitch).addClass("checked");
      }
    });
    // -------------Button ripple---------------
    ;(function($, window, document, undefined) {
    'use strict';
    var $ripple = $('.js-ripple');
    $ripple.on('click.ui.ripple', function(e) {

      let idButton = $(this).parents().attr('id');
      var $this = $(this);
      var $offset = $this.parent().offset();
      var $circle = $this.find('.c-ripple-circle-'+idButton);
      var x = e.pageX - $offset.left;
      var y = e.pageY - $offset.top;

      $circle.css({
        top: y + 'px',
        left: x + 'px'
      });
      $this.addClass('is-active');
    });
    $ripple.on('animationend webkitAnimationEnd oanimationend MSAnimationEnd', function(e) {
      $(this).removeClass('is-active');
    });
    })(jQuery, window, document);

    // -------------Popup---------------
    $(document).ready(function() {

      let date = new Date(Date.now() + 31536000000); //31536000000 = 365 jour
      date = date.toUTCString();

      let popupConsent = $('#popupConsent');
      let acceptButton = $( "#accept" );
      let configureButton = $( "#configure" );
      let enregistreButton = $( "#enregistre" );
      let configureSection = $('#configureSection');
      let contentPopupConsent = $('#contentPopupConsent');


      function getCookieValue(name) {
        let result = document.cookie.match("(^|[^;]+)\\s*" + name + "\\s*=\\s*([^;]+)")
        return result ? result.pop() : ""
      }

      if(!getCookieValue("cookieConsent")){
        $(popupConsent).show(200);
        document.getElementById("backgroundPopup").classList.add('background-popup');
      }

      $(acceptButton).click(function() {
        $(popupConsent).fadeOut(1000);
        document.cookie = 'autoriseGeolocation=true; path=/; expires=' + date;
        document.cookie = 'targetedAdvertising=true; path=/; expires=' + date;
        document.cookie = 'cookieConsent=true; path=/; expires=' + date;
        document.cookie = 'popupConsent=true; path=/; expires=' + date;
        document.getElementById("backgroundPopup").classList.remove('background-popup');
        (adsbygoogle=window.adsbygoogle||[]).pauseAdRequests=0;
        (adsbygoogle = window.adsbygoogle || []).push({});
       });

      $(configureButton).click(function() {
        $(configureButton).fadeOut(0);
        $(enregistreButton).fadeIn(0);
        $(contentPopupConsent).fadeOut(0);
        $(configureSection).fadeIn(1000);
      });

      $(enregistreButton).click(function() {
        $(popupConsent).fadeOut(1000);
        document.getElementById("backgroundPopup").classList.remove('background-popup');
        // Insérer les cookies
        if(!$('#autoriseGeolocation').hasClass('checked')){
          document.cookie = 'autoriseGeolocation=false; path=/; expires=' + date;
        }
        if($('#autoriseGeolocation').hasClass('checked')){
          document.cookie = 'autoriseGeolocation=true; path=/; expires=' + date;
        }
        if(!$('#targetedAdvertising').hasClass('checked')){
          document.cookie = 'targetedAdvertising=false; path=/; expires=' + date;
          (adsbygoogle=window.adsbygoogle||[]).requestNonPersonalizedAds=1;
        }
        if($('#targetedAdvertising').hasClass('checked')){
          document.cookie = 'targetedAdvertising=true; path=/; expires=' + date;
        }
        if(!$('#cookieConsent').hasClass('checked')){
          document.cookie = 'cookieConsent=false; path=/; expires=' + date;
        }
        if($('#cookieConsent').hasClass('checked')){
          document.cookie = 'cookieConsent=true; path=/; expires=' + date;
        }
        document.cookie = 'popupConsent=true; path=/; expires=' + date;
        (adsbygoogle=window.adsbygoogle||[]).pauseAdRequests=0;
        (adsbygoogle = window.adsbygoogle || []).push({});
      });
    });
  </script>
  <?php
}
?>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6769387355182536" crossorigin="anonymous"></script>
<div id="backgroundPopup"></div>
<div id="backgroundMenuPopup"></div>
<div id="backgroundMenu"></div>

    </body>
</html>